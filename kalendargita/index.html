<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Kalendar Mood Gita — Protected</title>
<style>
  :root{--bg:#0b0c10;--card:#121318;--muted:#9aa3b2;--text:#e8edf2;--border:#1e2230;}
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter, Roboto, system-ui, Arial;background:var(--bg);color:var(--text)}
  .wrap{max-width:1100px;margin:24px auto;padding:16px}
  /* Minimal styles for header/panel (reuse your earlier calendar CSS if desired) */
  header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
  h1{font-size:20px;margin:0}
  .panel{background:var(--card);border:1px solid var(--border);padding:12px;border-radius:10px}
  /* Lock overlay */
  .overlay{
    position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
    background:linear-gradient(rgba(5,8,12,0.7), rgba(5,8,12,0.85));backdrop-filter:blur(4px);z-index:9999;
  }
  .locker{background:#0f1720;border:1px solid #22262f;padding:22px;border-radius:12px;min-width:320px;max-width:92vw}
  .locker h2{margin:0 0 8px;font-size:18px}
  .locker p{margin:0 0 12px;color:var(--muted);font-size:13px}
  input[type="password"]{width:100%;padding:10px;border-radius:8px;border:1px solid #2a2f3a;background:#0b0f14;color:var(--text);margin-bottom:8px}
  button{background:#1f6feb;color:white;border:none;padding:10px 12px;border-radius:8px;cursor:pointer}
  .msg{font-size:13px;margin-top:8px;color:#ffb3b3}
  .small{font-size:12px;color:var(--muted);margin-top:10px}
  .hidden{display:none}
</style>
</head>
<body>
  <!-- Overlay / password prompt -->
  <div id="overlay" class="overlay" aria-hidden="false">
    <div class="locker" role="dialog" aria-modal="true" aria-labelledby="lockTitle">
      <h2 id="lockTitle">Masukkan kata sandi</h2>
      <p>Halaman ini dilindungi. Masukkan kata sandi untuk melihat Kalendar Mood Gita.</p>
      <input id="pw" type="password" placeholder="Masukkan password" autocomplete="current-password" />
      <div style="display:flex;gap:8px">
        <button id="btnUnlock">Buka</button>
        <button id="btnDemo" style="background:#6b7280">Isi contoh</button>
      </div>
      <div id="err" class="msg" role="status" aria-live="polite"></div>
      <div class="small">Password disimpan sebagai hash SHA-256 di kode. Untuk pengamanan lebih baik, gunakan proteksi server-side.</div>
    </div>
  </div>

  <!-- Main wrap (kalender + controls) -->
  <div id="main" class="wrap" style="display:none">
    <header>
      <h1>Kalendar Mood Gita</h1>
      <div style="color:var(--muted)">Protected view — unlocked</div>
    </header>

    <!-- Minimal placeholder; you can paste the full calendar HTML/JS here -->
    <div class="panel">
      <strong>Panduan</strong>
      <p class="small">Halaman ini menampilkan prediksi mood & fase harian pasangan. (Kalender lengkap akan muncul di sini — kamu bisa menyisipkan file kalender penuh yang sudah kubuat.)</p>
    </div>
  </div>

<script>
/*
  Client-side password check using SHA-256.
  - StoredHash is SHA-256("190199")
  - On correct entry, overlay hides and main content shows.
  - Value is not reversible from the hash alone (but client-side source can be inspected).
*/

const storedHash = "05154ed6409dfef1eea705521a0eaa57e78add451b3d29c4116ee035cd78c9f1";

// helper: compute SHA-256 hex of string using Web Crypto
async function sha256Hex(message) {
  if(!window.crypto || !window.crypto.subtle) {
    throw new Error("Browser tidak mendukung Web Crypto API");
  }
  const enc = new TextEncoder();
  const data = enc.encode(message);
  const hashBuffer = await crypto.subtle.digest("SHA-256", data);
  // convert buffer to hex
  const hashArray = Array.from(new Uint8Array(hashBuffer));
  const hashHex = hashArray.map(b => b.toString(16).padStart(2,"0")).join("");
  return hashHex;
}

const overlay = document.getElementById("overlay");
const main = document.getElementById("main");
const pwInput = document.getElementById("pw");
const btnUnlock = document.getElementById("btnUnlock");
const err = document.getElementById("err");
const btnDemo = document.getElementById("btnDemo");

// Persist unlocked state in sessionStorage (so page refresh during same session stays unlocked)
const storageKey = "kalendargita_unlocked_v1";

async function tryUnlock(typed){
  err.textContent = "";
  try {
    const hex = await sha256Hex(typed.trim());
    if(hex === storedHash){
      sessionStorage.setItem(storageKey, "1");
      overlay.style.display = "none";
      overlay.setAttribute("aria-hidden","true");
      main.style.display = "";
      // focus first element inside main
      const first = main.querySelector("button, a, input");
      if(first) first.focus();
      return true;
    } else {
      err.textContent = "Kata sandi salah — coba lagi.";
      return false;
    }
  } catch(e) {
    err.textContent = "Browser kamu tidak mendukung keamanan yang diperlukan.";
    console.error(e);
    return false;
  }
}

btnUnlock.addEventListener("click", ()=> tryUnlock(pwInput.value));
pwInput.addEventListener("keydown", (e)=> { if(e.key === "Enter") tryUnlock(pwInput.value); });

// demo helper to auto-fill (you can remove)
btnDemo.addEventListener("click", ()=> { pwInput.value = "190199"; tryUnlock("190199"); });

// on load, check session storage
if(sessionStorage.getItem(storageKey) === "1"){
  overlay.style.display = "none";
  overlay.setAttribute("aria-hidden","true");
  main.style.display = "";
} else {
  pwInput.focus();
}

</script>
</body>
</html>
